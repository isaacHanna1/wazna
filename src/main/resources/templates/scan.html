<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WZNA</title>
    <link rel="stylesheet" href="./css/styles.css" />
  </head>
  <body>
  <!-- Include the navbar fragment -->
  <div th:insert="~{fragments/navbar :: mainNavbar}"></div>
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    <div class="container protected-content">
      <div style="max-width: 32rem; margin: 0 auto">
        <div class="scan-container">
          <div class="scan-header">
            <svg
              width="64"
              height="64"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <path d="M8 8v8h8"></path>
            </svg>
            <h1
              style="font-size: 1.5rem; font-weight: 700; margin-top: 0.75rem"
            >
              Scan QR Code
            </h1>
            <p style="margin-top: 0.5rem">
              Scan the event QR code to check in and earn points
            </p>
          </div>

          <div class="scan-content">
            <!-- Ready to scan state -->
            <div id="scan-ready">
              <div class="scan-placeholder cursor-pointer" id="reader" onclick="startScan();">
                <svg
                  width="96"
                  height="96"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <path d="M8 8v8h8"></path>
                </svg>
                <p style="margin-top: 0.5rem">Ready to scan</p>
              </div>

              <button id="scan-button" class="btn btn-primary" onclick="startScan()">
                Start Scanning
              </button>

              <div class="scan-info" >
                <svg
                  class="scan-info-icon"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                <p>
                  Point your camera at the event QR code to check in. Make sure
                  the code is clearly visible and well-lit.
                </p>
              </div>
            </div>

            <!-- Scanning state -->
            <div id="scanning" style="display: none">
              <div class="scan-placeholder">
                <div style="position: relative">
                  <svg
                    width="96"
                    height="96"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <rect
                      x="3"
                      y="3"
                      width="18"
                      height="18"
                      rx="2"
                      ry="2"
                    ></rect>
                    <path d="M8 8v8h8"></path>
                  </svg>
                  <div
                    style="
                      position: absolute;
                      inset: 0;
                      border: 4px solid rgba(110, 89, 165, 0.5);
                      border-radius: 0.375rem;
                      animation: pulse 2s infinite;
                    "
                  ></div>
                </div>
                <p style="margin-top: 0.5rem">Scanning...</p>
              </div>

              <button id ='stop-btn'
                class="btn btn-secondary"
                onclick="stopScan();"
              >
                Cancel
              </button>
            </div>

            <!-- Success state -->
            <div id="scan-success" style="display: none">
              <div class="scan-success">
                <div class="success-icon-container">
                  <svg
                    class="success-icon"
                    width="32"
                    height="32"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                  </svg>
                </div>
                <h3 class="success-title">Check-in Successful!</h3>
                <p class="success-points">You've earned 50 points</p>

                <div class="event-details-card">
                  <h4
                    style="
                      font-weight: 700;
                      font-size: 1.125rem;
                      margin-bottom: 0.5rem;
                    "
                  >
                    Youth Leadership Workshop
                  </h4>
                  <p style="color: #666; margin-bottom: 0.25rem">
                    May 15, 2025
                  </p>
                  <p style="color: #666; margin-bottom: 0.25rem">
                    4:00 PM - 6:00 PM
                  </p>
                  <p style="color: #666">Community Center Hall A</p>
                </div>
              </div>

              <button id="reset-scan" class="btn btn-primary">
                Scan Another Code
              </button>

              <a
                href="index.html"
                class="btn btn-secondary"
                style="margin-top: 1rem"
              >
                Return to Home
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>


    
    <!--hidden values-->
    <input type="hidden" id="result" name="result" value=""/>
    <input type="hidden" id="user_Id" name="user_Id" th:value="${userId}"/>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script th:src="@{/js/scan.js}"></script>
    <script th:src="@{/js/nav.js}"></script>
    <script th:src="@{./js/jCommon/Common.js}"></script>
  </body>
</html>
